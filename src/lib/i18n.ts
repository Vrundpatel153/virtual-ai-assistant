import { useEffect, useMemo, useState } from 'react';
import { settingsManager } from './historyManager';

// Minimal i18n dictionary (English/Hindi) for key UI strings
const dict = {
  en: {
    appName: 'AI Assistant',
    subtitle: 'Chat + Voice + AI Tools',
    chat: 'Chat',
    voice: 'Voice',
    aiTools: 'AI Tools',
    chatHeader: 'Chat Assistant',
    chatTagline: 'Have a conversation with your AI assistant',
    settings: 'Settings',
    profile: 'Profile',
    notifications: 'Notifications',
    home: 'Home',
    chatPlaceholder: 'Type your message...',
    newChat: 'New Chat',
    send: 'Send',
    tokenUsedToday: 'Used today',
    upgradePlan: 'Upgrade plan',
    performanceReduceLoad: 'Reduce Load',
    performanceDesc: 'Toggle for a faster, more efficient experience',
    language: 'Language',
    english: 'English',
    hindi: 'Hindi',
    reminderInApp: 'In-app notification',
    reminderEmail: 'Email notification',
    saveChanges: 'Save Changes',
    resetDefaults: 'Reset to Defaults',
    pricing: 'Pricing',
    logout: 'Logout',
  settingsSaved: 'Settings saved.',
    // Voice
    voiceAssistantTitle: 'Voice Assistant',
    voiceAssistantSubtitle: 'Speak naturally and let AI understand you',
    startRecording: 'Start Recording',
    stopRecording: 'Stop Recording',
    history: 'History',
    transcript: 'Transcript',
    recognized: 'Recognized',
    assistant: 'Assistant',
    noRecordingsYet: 'No recordings yet',
    deleteRecordingQuestion: 'Delete this recording?',
    youLabel: 'You',
    assistantLabel: 'Assistant',
    dailyTokenLimitReached: 'Daily token limit reached',
    dailyTokenLimitMessage: "You've used your daily token limit. To continue, add your own API key or upgrade your plan.",
    addApiKey: 'Add API Key',
    viewPricing: 'View Pricing',
    deleteConversationQuestion: 'Delete this conversation?',
    demoAiResponse: 'I understand your message. This is a demo response. In a real application, this would connect to an AI service.',
    aiKeyRequired: 'This request requires an API key for an AI response. Local automations ran if available.',
    chatWelcome: "Hello! I'm your AI assistant. How can I help you today?",
    // AITools / Notifications common
    notificationsPageTitle: 'Notifications',
    notificationsPageSubtitle: 'Stay on top of reminders and system updates',
    markAllRead: 'Mark all read',
    clear: 'Clear',
    allNotifications: 'All Notifications',
    unreadCount: '{count} unread',
    noNotificationsYet: 'No notifications yet',
    markAsRead: 'Mark as read',
    reminders: 'Reminders',
    noRemindersYet: 'No reminders yet',
    completed: 'Completed',
    dueAt: 'Due {when}',
    emailLabel: 'Email: {email} {sent}',
    emailSent: '(sent)',
    outbox: 'Email Outbox (mock)',
    noEmailsSent: 'No emails sent',
    toLabel: 'To: {to}',
    historyTitle: 'History',
    pdfSummaries: 'PDF Summaries',
    noPdfSummaries: 'No PDF summaries yet',
    // AI Tools
    aiToolsTitle: 'AI Tools',
    aiToolsSubtitle: 'Powerful AI tools: PDF summaries, reminders with in-app notifications and mock email alerts.',
    pdfSummarizer: 'PDF Summarizer',
    clickToUploadPdf: 'Click to upload PDF',
    fileReady: 'File ready to summarize',
    maxFileSize: 'Maximum file size: 10MB',
    processing: 'Processing...',
    generateSummary: 'Generate Summary',
    setReminder: 'Set Reminder',
    description: 'Description',
    date: 'Date',
    time: 'Time',
    emailOptional: 'Email (optional, used only if email notifications are enabled in Settings)',
    mockEmailNote: "We'll send a mock email when it's due.",
    createReminder: 'Create Reminder',
    summaryResult: 'Summary Result',
    moreToolsComing: 'More Tools Coming Soon',
    moreToolsDesc: "We're constantly adding new AI-powered tools to enhance your productivity. Stay tuned for updates!",
    // Prompts / placeholders / alerts
    pleaseSelectPdf: 'Please select a PDF file',
    enterReminderDescription: 'Please enter a reminder description',
    deletePdfSummaryQuestion: 'Delete this PDF summary?',
    deleteReminderQuestion: 'Delete this reminder?',
    reminderSetFor: 'Reminder set for {when}',
    reminderPlaceholder: 'e.g., "Pay bills"',
    emailPlaceholder: 'you@example.com',
    done: 'Done',
    // Settings page
    settingsSubtitle: 'Customize your AI assistant experience',
    appearanceTitle: 'Appearance',
    appearanceDesc: 'Customize the look and feel',
    theme: 'Theme',
    themeDesc: 'Toggle between light and dark mode',
    remindersTitle: 'Reminder notifications',
    remindersDesc: 'Choose how you want to be notified when a reminder is due',
    onlyRemindersNote: 'Only reminders use these preferences.',
    apiKeyTitle: 'API Key',
    apiKeyDesc: 'Use your own provider key to bypass token limits',
    pasteApiKey: 'Paste your API key',
    localKeyNote: 'Your key is stored locally in your browser.',
    tokenUsageTitle: 'Token usage',
    tokenUsageDesc: 'Daily usage resets automatically at midnight',
    hideUsageInChat: 'Hide token usage in Chat',
    privacyTitle: 'Privacy & Security',
    privacyDesc: 'Control your data and security settings',
    twoFactor: 'Two-factor authentication',
    dataEncryption: 'Data encryption',
    changePassword: 'Change Password',
    performanceTitle: 'Performance',
    performanceNote: 'Disables heavy visuals like the 3D model. Re-enable anytime.',
    languageDesc: 'Choose your preferred language',
    // Landing
    landingTitle: 'AI Assistant Hub',
    signIn: 'Sign In',
    signUp: 'Sign Up',
    nameLabel: 'Name',
    emailInputLabel: 'Email',
    passwordLabel: 'Password',
    namePlaceholder: 'Your name',
    emailInputPlaceholder: 'your@email.com',
    passwordPlaceholder: '••••••••',
    fillAllFields: 'Please fill in all fields',
    loginFailed: 'Login failed',
    signupFailed: 'Signup failed',
    orContinueWith: 'Or continue with',
    google: 'Google',
    experienceTagline: 'Experience the power of AI-driven conversations and tools',
    googleEmailPrompt: 'Enter your Google email:',
    googleNamePrompt: 'Enter your name:',
    // Profile
    editProfile: 'Edit Profile',
    loginMethodGoogle: 'Google Login',
    loginMethodEmail: 'Email Login',
    joinedMarch2024: 'Joined March 2024',
    recentActivityTitle: 'Recent Activity',
    statsTotalChats: 'Total Chats',
    statsVoiceSessions: 'Voice Sessions',
    statsActiveAgents: 'Active Agents',
    statsHoursSaved: 'Hours Saved',
    // Template (Home)
    intelligentChatAssistant: 'Intelligent\nChat\nAssistant',
    realtimeResponses: 'Real-time responses',
    contextAwareConversations: 'Context-aware conversations',
    totalChatsLower: 'total chats',
    startChat: 'Start Chat',
    aiAssistantLabel: 'AI Assistant',
    voiceCardTitle: 'Voice assistant',
    voiceCardDesc: 'Natural voice interactions with speech recognition.',
    aiToolsCardTitle: 'AI tools',
    aiToolsCardDesc: 'Summaries, reminders and more to power your workflow.',
    sessionsLabel: 'sessions',
    hoursActive: 'hours active',
    analyticsInsights: 'Analytics & insights',
    trackUsage: 'Track usage patterns and performance metrics.',
    insightsLabel: 'Insights',
    realtimeLabel: 'Real-time',
    usageLabel: 'Usage',
    speedLabel: 'Speed',
    qualityLabel: 'Quality',
    // Pricing
    pricingSubtitle: 'Upgrade your daily token limit instantly.',
    freeName: 'Free',
    proName: 'Pro',
    premiumName: 'Premium',
    planFreeDesc: 'Great to start',
    planProDesc: 'For active users',
    planPremiumDesc: 'Power users',
    featureLocalTools: 'Local tools',
    featureRemindersNotifications: 'Reminders & notifications',
    featurePriorityFeatures: 'Priority features',
    featureEmailSupport: 'Email support',
    featureAllFeatures: 'All features',
    featurePrioritySupport: 'Priority support',
    bestValue: 'Best value',
    tokensPerDay: '{count} tokens/day',
    choosePlan: 'Choose plan',
    currentPlan: 'Current plan',
    planUpdatedAlert: 'Plan updated to {plan}. Token limit refreshed for today.',
  },
  hi: {
    appName: 'एआई सहायक',
    subtitle: 'चैट • वॉइस • एआई टूल्स',
    chat: 'चैट',
    voice: 'वॉइस',
    aiTools: 'एआई टूल्स',
    chatHeader: 'चैट सहायक',
    chatTagline: 'अपने एआई सहायक के साथ बातचीत करें',
    settings: 'सेटिंग्स',
    profile: 'प्रोफ़ाइल',
    notifications: 'सूचनाएं',
    home: 'होम',
    chatPlaceholder: 'अपना संदेश लिखें...',
    newChat: 'नया चैट',
    send: 'भेजें',
    tokenUsedToday: 'आज उपयोग',
    upgradePlan: 'प्लान अपग्रेड करें',
    performanceReduceLoad: 'कम लोड',
    performanceDesc: 'तेज़ और कुशल अनुभव के लिए टॉगल',
    language: 'भाषा',
    english: 'अंग्रेज़ी',
    hindi: 'हिंदी',
    reminderInApp: 'इन-ऐप सूचना',
    reminderEmail: 'ईमेल सूचना',
    saveChanges: 'परिवर्तन सहेजें',
    resetDefaults: 'डिफ़ॉल्ट पर रीसेट',
    pricing: 'मूल्य निर्धारण',
    logout: 'लॉगआउट',
  settingsSaved: 'सेटिंग्स सहेजी गईं।',
    // Voice
    voiceAssistantTitle: 'वॉइस सहायक',
    voiceAssistantSubtitle: 'स्वाभाविक रूप से बोलें और एआई आपको समझे',
    startRecording: 'रिकॉर्डिंग शुरू करें',
    stopRecording: 'रिकॉर्डिंग रोकें',
    history: 'इतिहास',
    transcript: 'ट्रांसक्रिप्ट',
    recognized: 'पहचाना गया',
    assistant: 'सहायक',
    noRecordingsYet: 'अभी कोई रिकॉर्डिंग नहीं',
    deleteRecordingQuestion: 'क्या आप यह रिकॉर्डिंग हटाना चाहते हैं?',
    youLabel: 'आप',
    assistantLabel: 'सहायक',
    dailyTokenLimitReached: 'दैनिक टोकन सीमा पूरी हो गई',
    dailyTokenLimitMessage: 'आपने आज की टोकन सीमा का उपयोग कर लिया है। जारी रखने के लिए अपनी API कुंजी जोड़ें या अपना प्लान अपग्रेड करें।',
    addApiKey: 'API कुंजी जोड़ें',
    viewPricing: 'मूल्य देखें',
    deleteConversationQuestion: 'क्या आप यह बातचीत हटाना चाहते हैं?',
    demoAiResponse: 'मैंने आपका संदेश समझ लिया। यह एक डेमो प्रतिक्रिया है। असली एप्लिकेशन में, यह किसी एआई सेवा से जुड़ेगा।',
    aiKeyRequired: 'इस अनुरोध के लिए एआई प्रतिक्रिया हेतु API कुंजी आवश्यक है। उपलब्ध होने पर स्थानीय कार्य चलाए गए।',
    chatWelcome: 'नमस्ते! मैं आपका एआई सहायक हूँ। मैं आज आपकी कैसे मदद कर सकता हूँ?',
    // AITools / Notifications common
    notificationsPageTitle: 'सूचनाएं',
    notificationsPageSubtitle: 'रिमाइंडर और सिस्टम अपडेट पर नज़र रखें',
    markAllRead: 'सभी को पढ़ा चिह्नित करें',
    clear: 'साफ़ करें',
    allNotifications: 'सभी सूचनाएं',
    unreadCount: '{count} अपठित',
    noNotificationsYet: 'अभी कोई सूचना नहीं',
    markAsRead: 'पढ़ा चिह्नित करें',
    reminders: 'रिमाइंडर्स',
    noRemindersYet: 'अभी कोई रिमाइंडर नहीं',
    completed: 'पूर्ण',
    dueAt: '{when} को देय',
    emailLabel: 'ईमेल: {email} {sent}',
    emailSent: '(भेजा गया)',
    outbox: 'ईमेल आउटबॉक्स (मॉक)',
    noEmailsSent: 'अभी कोई ईमेल नहीं भेजा गया',
    toLabel: 'प्रति: {to}',
    historyTitle: 'इतिहास',
    pdfSummaries: 'पीडीएफ सारांश',
    noPdfSummaries: 'अभी कोई पीडीएफ सारांश नहीं',
    // AI Tools
    aiToolsTitle: 'एआई टूल्स',
    aiToolsSubtitle: 'शक्तिशाली एआई टूल्स: पीडीएफ सारांश, रिमाइंडर्स (इन-ऐप और मॉक ईमेल अलर्ट)।',
    pdfSummarizer: 'पीडीएफ सारांशक',
    clickToUploadPdf: 'पीडीएफ अपलोड करने के लिए क्लिक करें',
    fileReady: 'फ़ाइल सारांश के लिए तैयार',
    maxFileSize: 'अधिकतम फ़ाइल आकार: 10MB',
    processing: 'प्रोसेसिंग...',
    generateSummary: 'सारांश बनाएं',
    setReminder: 'रिमाइंडर सेट करें',
    description: 'विवरण',
    date: 'तिथि',
    time: 'समय',
    emailOptional: 'ईमेल (वैकल्पिक, केवल तब उपयोग यदि सेटिंग्स में ईमेल सूचनाएं सक्षम हैं)',
    mockEmailNote: 'जब समय होगा तब हम एक मॉक ईमेल भेजेंगे।',
    createReminder: 'रिमाइंडर बनाएं',
    summaryResult: 'सारांश परिणाम',
    moreToolsComing: 'और टूल्स जल्द आ रहे हैं',
    moreToolsDesc: 'हम आपकी उत्पादकता बढ़ाने के लिए लगातार नए एआई टूल्स जोड़ रहे हैं। अपडेट के लिए जुड़े रहें!',
    // Prompts / placeholders / alerts
    pleaseSelectPdf: 'कृपया एक पीडीएफ फ़ाइल चुनें',
    enterReminderDescription: 'कृपया रिमाइंडर विवरण दर्ज करें',
    deletePdfSummaryQuestion: 'क्या आप यह पीडीएफ सारांश हटाना चाहते हैं?',
    deleteReminderQuestion: 'क्या आप यह रिमाइंडर हटाना चाहते हैं?',
    reminderSetFor: '{when} के लिए रिमाइंडर सेट किया गया',
    reminderPlaceholder: 'जैसे, "बिल भरें"',
    emailPlaceholder: 'you@example.com',
    done: 'पूर्ण',
    // Settings page
    settingsSubtitle: 'अपने एआई सहायक अनुभव को अनुकूलित करें',
    appearanceTitle: 'दिखावट',
    appearanceDesc: 'रूप और अनुभव को अनुकूलित करें',
    theme: 'थीम',
    themeDesc: 'लाइट और डार्क मोड के बीच टॉगल करें',
    remindersTitle: 'रिमाइंडर सूचनाएं',
    remindersDesc: 'जब रिमाइंडर देय हो तो आपको कैसे सूचित किया जाए, चुनें',
    onlyRemindersNote: 'केवल रिमाइंडर्स इन प्राथमिकताओं का उपयोग करते हैं।',
    apiKeyTitle: 'API कुंजी',
    apiKeyDesc: 'टोकन सीमा से बचने के लिए अपनी प्रदाता कुंजी का उपयोग करें',
    pasteApiKey: 'अपनी API कुंजी पेस्ट करें',
    localKeyNote: 'आपकी कुंजी आपके ब्राउज़र में स्थानीय रूप से संग्रहीत होती है।',
    tokenUsageTitle: 'टोकन उपयोग',
    tokenUsageDesc: 'दैनिक उपयोग आधी रात को स्वतः रीसेट हो जाता है',
    hideUsageInChat: 'चैट में टोकन उपयोग छुपाएं',
    privacyTitle: 'गोपनीयता और सुरक्षा',
    privacyDesc: 'अपने डेटा और सुरक्षा सेटिंग्स नियंत्रित करें',
    twoFactor: 'दो-कारक प्रमाणीकरण',
    dataEncryption: 'डेटा एन्क्रिप्शन',
    changePassword: 'पासवर्ड बदलें',
    performanceTitle: 'प्रदर्शन',
    performanceNote: '3D मॉडल जैसी भारी दृश्यावलियों को अक्षम करता है। कभी भी पुन: सक्षम करें।',
    languageDesc: 'अपनी पसंदीदा भाषा चुनें',
    // Landing
    landingTitle: 'एआई असिस्टेंट हब',
    signIn: 'साइन इन',
    signUp: 'साइन अप',
    nameLabel: 'नाम',
    emailInputLabel: 'ईमेल',
    passwordLabel: 'पासवर्ड',
    namePlaceholder: 'आपका नाम',
    emailInputPlaceholder: 'your@email.com',
    passwordPlaceholder: '••••••••',
    fillAllFields: 'कृपया सभी फ़ील्ड भरें',
    loginFailed: 'लॉगिन विफल',
    signupFailed: 'साइन अप विफल',
    orContinueWith: 'या इसके साथ जारी रखें',
    google: 'गूगल',
    experienceTagline: 'एआई-संचालित वार्तालापों और टूल्स की शक्ति का अनुभव करें',
    googleEmailPrompt: 'अपना गूगल ईमेल दर्ज करें:',
    googleNamePrompt: 'अपना नाम दर्ज करें:',
    // Profile
    editProfile: 'प्रोफ़ाइल संपादित करें',
    loginMethodGoogle: 'गूगल लॉगिन',
    loginMethodEmail: 'ईमेल लॉगिन',
    joinedMarch2024: 'मार्च 2024 में जुड़े',
    recentActivityTitle: 'हाल की गतिविधि',
    statsTotalChats: 'कुल चैट्स',
    statsVoiceSessions: 'वॉइस सेशंस',
    statsActiveAgents: 'सक्रिय एजेंट्स',
    statsHoursSaved: 'घंटे बचाए',
    // Template (Home)
    intelligentChatAssistant: 'बुद्धिमान\nचैट\nसहायक',
    realtimeResponses: 'रीयल-टाइम प्रतिक्रियाएं',
    contextAwareConversations: 'संदर्भ-जागरूक वार्तालाप',
    totalChatsLower: 'कुल चैट्स',
    startChat: 'चैट शुरू करें',
    aiAssistantLabel: 'एआई सहायक',
    voiceCardTitle: 'वॉइस सहायक',
    voiceCardDesc: 'स्पीच रिकग्निशन के साथ प्राकृतिक वॉइस इंटरैक्शन।',
    aiToolsCardTitle: 'एआई टूल्स',
    aiToolsCardDesc: 'आपके वर्कफ़्लो के लिए सारांश, रिमाइंडर्स और अधिक।',
    sessionsLabel: 'सेशंस',
    hoursActive: 'घंटे सक्रिय',
    analyticsInsights: 'एनालिटिक्स और इनसाइट्स',
    trackUsage: 'उपयोग पैटर्न और प्रदर्शन मैट्रिक्स ट्रैक करें।',
    insightsLabel: 'इनसाइट्स',
    realtimeLabel: 'रीयल-टाइम',
    usageLabel: 'उपयोग',
    speedLabel: 'गति',
    qualityLabel: 'गुणवत्ता',
    // Pricing
    pricingSubtitle: 'अपनी दैनिक टोकन सीमा तुरंत बढ़ाएं।',
    freeName: 'फ्री',
    proName: 'प्रो',
    premiumName: 'प्रीमियम',
    planFreeDesc: 'शुरू करने के लिए बढ़िया',
    planProDesc: 'सक्रिय उपयोगकर्ताओं के लिए',
    planPremiumDesc: 'पावर यूज़र्स',
    featureLocalTools: 'स्थानीय टूल्स',
    featureRemindersNotifications: 'रिमाइंडर और सूचनाएं',
    featurePriorityFeatures: 'प्राथमिकता फीचर्स',
    featureEmailSupport: 'ईमेल सपोर्ट',
    featureAllFeatures: 'सभी फीचर्स',
    featurePrioritySupport: 'प्राथमिकता सपोर्ट',
    bestValue: 'सबसे अच्छा विकल्प',
    tokensPerDay: '{count} टोकन/दिन',
    choosePlan: 'प्लान चुनें',
    currentPlan: 'वर्तमान प्लान',
    planUpdatedAlert: '{plan} प्लान अपडेट किया गया। आज के लिए टोकन सीमा रीफ्रेश की गई।',
  }
};

export function t(key: keyof typeof dict['en']): string {
  const lang = settingsManager.get().language || 'en';
  const table = dict[lang as 'en'|'hi'] || dict.en;
  return (table as any)[key] || key;
}

export function useI18n() {
  const [lang, setLang] = useState<'en'|'hi'>(settingsManager.get().language || 'en');
  useEffect(() => {
    const onSettings = (e: any) => setLang((e?.detail?.language) || settingsManager.get().language || 'en');
    window.addEventListener('ai_settings_updated', onSettings as any);
    return () => window.removeEventListener('ai_settings_updated', onSettings as any);
  }, []);
  const table = useMemo(()=> dict[lang] || dict.en, [lang]);
  return { lang, table, t: (key: keyof typeof dict['en']) => (table as any)[key] || key };
}
